{"id":"auth/jwt.strategy.ts","dependencies":[{"name":"/Users/dennisb/Projects/turing-fullstack/server/tsconfig.json","includedInParent":true,"mtime":1555922457917},{"name":"/Users/dennisb/Projects/turing-fullstack/server/package.json","includedInParent":true,"mtime":1561622380942},{"name":"./auth.service","loc":{"line":24,"column":31},"parent":"/Users/dennisb/Projects/turing-fullstack/server/src/auth/jwt.strategy.ts","resolved":"/Users/dennisb/Projects/turing-fullstack/server/src/auth/auth.service.ts"}],"generated":{"js":"\"use strict\";\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : new P(function (resolve) {\n        resolve(result.value);\n      }).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _a;\n\nconst common_1 = require(\"@nestjs/common\");\n\nconst passport_1 = require(\"@nestjs/passport\");\n\nconst passport_jwt_1 = require(\"passport-jwt\");\n\nconst auth_service_1 = require(\"./auth.service\");\n\nlet JwtStrategy = class JwtStrategy extends passport_1.PassportStrategy(passport_jwt_1.Strategy) {\n  constructor(authService) {\n    super({\n      jwtFromRequest: passport_jwt_1.ExtractJwt.fromAuthHeaderAsBearerToken(),\n      secretOrKey: 'secretKey'\n    });\n    this.authService = authService;\n  }\n\n  validate(payload) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const user = yield this.authService.validateUser(payload);\n\n      if (!user) {\n        throw new common_1.UnauthorizedException();\n      }\n\n      return user;\n    });\n  }\n\n};\nJwtStrategy = __decorate([common_1.Injectable(), __metadata(\"design:paramtypes\", [typeof (_a = typeof auth_service_1.AuthService !== \"undefined\" && auth_service_1.AuthService) === \"function\" ? _a : Object])], JwtStrategy);\nexports.JwtStrategy = JwtStrategy;"},"sourceMaps":{"js":{"mappings":[{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":49,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":49,"column":6}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":49,"column":14}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":49,"column":17}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":49,"column":24}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":49,"column":25}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":49,"column":41}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":49,"column":42}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":51,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":51,"column":6}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":51,"column":16}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":51,"column":19}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":51,"column":26}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":51,"column":27}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":51,"column":45}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":51,"column":46}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":53,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":53,"column":6}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":53,"column":20}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":53,"column":23}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":53,"column":30}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":53,"column":31}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":53,"column":45}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":53,"column":46}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":55,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":55,"column":6}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":55,"column":20}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":55,"column":23}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":55,"column":30}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":55,"column":31}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":55,"column":47}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":55,"column":48}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":0},"generated":{"line":57,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":13},"generated":{"line":57,"column":4}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":24},"generated":{"line":57,"column":15}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":0},"generated":{"line":57,"column":18}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":13},"generated":{"line":57,"column":24}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":0},"generated":{"line":57,"column":35}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":33},"generated":{"line":57,"column":44}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":33},"generated":{"line":57,"column":54}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":33},"generated":{"line":57,"column":55}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":33},"generated":{"line":57,"column":71}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":50},"generated":{"line":57,"column":72}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":50},"generated":{"line":57,"column":86}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":50},"generated":{"line":57,"column":87}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":33},"generated":{"line":57,"column":95}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":0},"generated":{"line":57,"column":96}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":59},"generated":{"line":57,"column":97}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":4},"generated":{"line":58,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":4},"generated":{"line":58,"column":2}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":4},"generated":{"line":58,"column":13}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":33},"generated":{"line":58,"column":14}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":4},"generated":{"line":58,"column":25}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":57},"generated":{"line":58,"column":27}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":10,"column":8},"generated":{"line":59,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":10,"column":14},"generated":{"line":59,"column":10}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":10,"column":16},"generated":{"line":60,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":10,"column":16},"generated":{"line":60,"column":6}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":10,"column":30},"generated":{"line":60,"column":20}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":10,"column":32},"generated":{"line":60,"column":22}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":10,"column":32},"generated":{"line":60,"column":36}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":10,"column":32},"generated":{"line":60,"column":37}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":10,"column":32},"generated":{"line":60,"column":47}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":10,"column":43},"generated":{"line":60,"column":48}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":10,"column":32},"generated":{"line":60,"column":75}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":10,"column":14},"generated":{"line":60,"column":77}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":10,"column":74},"generated":{"line":61,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":10,"column":74},"generated":{"line":61,"column":6}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":10,"column":85},"generated":{"line":61,"column":17}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":10,"column":87},"generated":{"line":61,"column":19}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":10,"column":14},"generated":{"line":62,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":10,"column":8},"generated":{"line":62,"column":5}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":33},"generated":{"line":63,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":33},"generated":{"line":63,"column":9}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":33},"generated":{"line":63,"column":20}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":33},"generated":{"line":63,"column":23}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":33},"generated":{"line":63,"column":34}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":11,"column":5},"generated":{"line":64,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":13,"column":10},"generated":{"line":66,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":13,"column":10},"generated":{"line":66,"column":2}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":13,"column":18},"generated":{"line":66,"column":10}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":13,"column":19},"generated":{"line":66,"column":11}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":13,"column":18},"generated":{"line":66,"column":18}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":13,"column":38},"generated":{"line":66,"column":20}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":14,"column":8},"generated":{"line":68,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":14,"column":14},"generated":{"line":68,"column":12}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":14,"column":18},"generated":{"line":68,"column":16}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":14,"column":21},"generated":{"line":68,"column":19}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":14,"column":27},"generated":{"line":68,"column":25}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":14,"column":32},"generated":{"line":68,"column":30}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":14,"column":27},"generated":{"line":68,"column":41}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":14,"column":44},"generated":{"line":68,"column":42}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":14,"column":27},"generated":{"line":68,"column":54}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":14,"column":57},"generated":{"line":68,"column":55}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":14,"column":27},"generated":{"line":68,"column":62}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":14,"column":8},"generated":{"line":68,"column":63}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":15,"column":8},"generated":{"line":70,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":15,"column":12},"generated":{"line":70,"column":10}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":15,"column":13},"generated":{"line":70,"column":11}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":15,"column":8},"generated":{"line":70,"column":15}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":15,"column":19},"generated":{"line":70,"column":17}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":16,"column":12},"generated":{"line":71,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":16,"column":18},"generated":{"line":71,"column":14}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":16,"column":22},"generated":{"line":71,"column":18}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":16,"column":22},"generated":{"line":71,"column":26}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":16,"column":22},"generated":{"line":71,"column":27}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":16,"column":18},"generated":{"line":71,"column":48}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":16,"column":12},"generated":{"line":71,"column":50}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":17,"column":9},"generated":{"line":72,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":18,"column":8},"generated":{"line":74,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":18,"column":15},"generated":{"line":74,"column":13}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":18,"column":8},"generated":{"line":74,"column":17}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":19,"column":5},"generated":{"line":75,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":19,"column":5},"generated":{"line":76,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":59},"generated":{"line":78,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":0},"generated":{"line":78,"column":1}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":13},"generated":{"line":79,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":24},"generated":{"line":79,"column":11}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":24},"generated":{"line":79,"column":14}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":24},"generated":{"line":79,"column":24}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":24},"generated":{"line":79,"column":25}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":7,"column":1},"generated":{"line":79,"column":26}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":7,"column":1},"generated":{"line":79,"column":34}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":7,"column":1},"generated":{"line":79,"column":35}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":7,"column":1},"generated":{"line":79,"column":45}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":24},"generated":{"line":79,"column":47}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":46},"generated":{"line":79,"column":102}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":46},"generated":{"line":79,"column":116}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":46},"generated":{"line":79,"column":117}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":57},"generated":{"line":79,"column":133}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":46},"generated":{"line":79,"column":148}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":46},"generated":{"line":79,"column":162}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":46},"generated":{"line":79,"column":163}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":57},"generated":{"line":79,"column":180}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":57},"generated":{"line":79,"column":193}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":9,"column":57},"generated":{"line":79,"column":198}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":24},"generated":{"line":79,"column":206}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":24},"generated":{"line":79,"column":207}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":13},"generated":{"line":79,"column":209}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":24},"generated":{"line":79,"column":220}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":13},"generated":{"line":79,"column":221}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":13},"generated":{"line":80,"column":0}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":13},"generated":{"line":80,"column":7}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":13},"generated":{"line":80,"column":8}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":13},"generated":{"line":80,"column":19}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":13},"generated":{"line":80,"column":22}},{"source":"auth/jwt.strategy.ts","name":null,"original":{"line":8,"column":13},"generated":{"line":80,"column":33}}],"sources":{"auth/jwt.strategy.ts":"import { Injectable, UnauthorizedException } from '@nestjs/common';\nimport { PassportStrategy } from '@nestjs/passport';\nimport { ExtractJwt, Strategy } from 'passport-jwt';\nimport { AuthService } from './auth.service';\nimport { JwtPayload } from './interfaces/jwt-payload.interface';\n\n@Injectable()\nexport class JwtStrategy extends PassportStrategy(Strategy) {\n    constructor(private readonly authService: AuthService) {\n        super({ jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(), secretOrKey: 'secretKey', });\n    }\n\n    async validate(payload: JwtPayload) {\n        const user = await this.authService.validateUser(payload);\n        if (!user) {\n            throw new UnauthorizedException();\n        }\n        return user;\n    }\n}\n"},"lineCount":null}},"error":null,"hash":"ec0ce5943437c35d10806e9ce9aed750","cacheData":{"env":{}}}